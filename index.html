<!DOCTYPE HTML><html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>test</title>
	<script src="script/jquery-1.12.2.min.js"></script>
	<script src="script/jquery.inputmask.min.js" type="text/javascript"></script>
	<style>
	.popup-box {
		position: absolute;
		border-radius: 5px;
		background: #fff;
		display: none;
		box-shadow: 1px 1px 5px rgba(0,0,0,0.2);
		font-family: Arial, sans-serif;
		z-index: 9999999;
		font-size: 14px;
	}

	.popup-box .close {
		position: absolute;
		top: 0px;
		right: 0px;
		font-family: Arial, Helvetica, sans-serif;
		font-weight: bold;
		cursor: pointer;
		color: #434343;
		padding: 20px;
		font-size: 20px;
	}

	.popup-box .close:hover {
		color: #000;
	}

	.popup-box h2 {
		padding: 0;
		margin: 0;
		font-size: 18px;
	}
	.popup-box .top {
		padding: 20px;
	}

	.popup-box .bottom {
		background: #eee;
		border-top: 1px solid #e5e5e5;
		padding: 20px;
		border-bottom-left-radius: 5px;
		border-bottom-right-radius: 5px;
	}

	#blackout {
		background: rgba(0,0,0,0.3);
		position: absolute;
		top: 0;
		overflow: hidden;
		z-index: 9999;
		left: 0;
		display: none;
	}
	</style>
</head>
<body>

<div id="nmpd">
	<table>
		<tbody>
			<tr>
				<td colspan="3">
					<input class="display" type="text" value="">
				</td>
				<td>
					<button class="del" type="button" style="width: 100%;">&lt; Удалить</button>
				</td>
			</tr>
			<tr>
				<td>
					<button class="numero" type="button" style="width: 100%;">1</button>
				</td>
				<td>
					<button class="numero" type="button" style="width: 100%;">2</button>
				</td>
				<td>
					<button class="numero" type="button" style="width: 100%;">3</button>
				</td>
			</tr>
			<tr>
				<td>
					<button class="numero" type="button" style="width: 100%;">4</button>
				</td>
				<td>
					<button class="numero" type="button" style="width: 100%;">5</button>
				</td>
				<td>
					<button class="numero" type="button" style="width: 100%;">6</button>
				</td>
			</tr>
			<tr>
				<td>
					<button class="numero" type="button" style="width: 100%;">7</button>
				</td>
				<td>
					<button class="numero" type="button" style="width: 100%;">8</button>
				</td>
				<td>
					<button class="numero" type="button" style="width: 100%;">9</button>
				</td>
			</tr>
			<tr>
				<td colspan="3">
					<button class="numero" type="button" style="width: 100%;">0</button>
				</td>
			</tr>
			<tr>
				<td colspan="3">
					<button class="submit" type="button" style="width: 100%;">Проверить</button>
				</td>
			</tr>
		</tbody>
	</table>
</div>

<div class="popup-box" id="popup-box-1"><div class="close">X</div>
<div id="content"></div>
</div>

11336517729

<script type="text/javascript">
	$(document).ready(function(){

		var inp = $("#nmpd .display"),
			inplen = 0,
			container = $('#content'),
			srvadr = "http://r15.fss.ru/168882/index.phtml .title-snils div";

			inp.inputmask("999-999-999 99")

			$.ajaxSetup({//время ожидания ответа от сервера 20 сек.
				timeout: 20000
			});

			inp.val("");

		//ввод цифр
		$("#nmpd .numero").bind("click", function(e){
			//Ограничение в 11 цифр
			if (inplen < 11){
				inplen = inplen+1;
				inp.val(inp.inputmask('unmaskedvalue')+$(this).text());
			}
		});

		//кнопка Del
		$("#nmpd .del").bind("click", function(e){
			//если есть хотябы одна цифра
			if (inplen>0){
				inp.val(inp.inputmask('unmaskedvalue').toString().substr(0,inplen-1));
				inplen = inplen-1;
			}
		});

		//При ручном вводе пересчет inplen
		inp.on("keyup", function(e){
			inplen = inp.inputmask('unmaskedvalue').length;
		});

		//Отправка запроса
		$("#nmpd .submit").click(function(e){
			//alert(inp.inputmask('unmaskedvalue'));

			snils=inp.inputmask('unmaskedvalue');

			container.html("Подождите...");

			if (snils.length == 11){
				//для загрузки этой страницы необходим достуа к кросс-доменным запросам:
				// - в IE настроить: Свойства браузера > Безопасность > Надежные узлы > Другой...
				//   Разное > Доступ к источникам данных > Включить
				//   Еще хорошо бы добавить адрес сайта в "Надежные сайты" кнопка Сайты
				// - в FireFox: Вкладка Дополнения > Расширения > найти и установить "cors everywhere".
				//   Затем "Изменить" в меню браузера, перетацить кнопку "CorsE" (запуск вручную).
				//   Для автоматического запуска плагина "cors_everywhere" при старке FireFox
				//   1. В строке адреса вбить "about:config"
				//   2. В любом месте тыкнуть "правую кнопку мыши"
				//   3. "Создать" > "Логическое"
				//   4. Ввести имя "extensions.spenibus_corsEverywhere.enabledAtStartup"
				//   5. Выбирите "true"
				// - или же на сервера прописать права "Access-Control-Allow-Origin *",
				//   например в .htaccess:   Header add Access-Control-Allow-Origin "*"
				container.load(srvadr, {'SNILS':snils},
				function(response, status, xhr){
					if (status=='success') {
						if(container.html() == ""){
							container.html(	"<p>В базе данных СНИЛС (<b>" + inp.val() + "</b>) не найден.</p>" +
											"<p>Проверьте правильность ввода СНИЛС.</p>");
						}
					} else {
						container.html(	"<p>Нет доступа к серверу.</p>" +
										"<p>Повторите попытку позже...</p>");
					}
				});

			}else{
				container.html(	"<p>Введён неверный номер СНИЛС.</p>" +
								"<p>Следует ввести все 11 цифр номера.</p>");
			}

// --- popup --------------

			/* Предотвращаем действия по умолчанию */
			e.preventDefault();
			e.stopPropagation();

			/* Получаем id (последний номер в имени класса ссылки) */
			var scrollPos = $(window).scrollTop();

			/* Корректный вывод popup окна, накрытие тенью, предотвращение скроллинга */
			$('#popup-box-1').show();
			$('#blackout').show();
			$('html,body').css('overflow', 'hidden');

			/* Убираем баг в Firefox */
			$('html').scrollTop(scrollPos);

		});

	$('body').append('<div id="blackout"></div>');

	function centerBox() {

		/* Preliminary information */
		var winWidth = $(window).width();
		var winHeight = $(document).height();
		var scrollPos = $(window).scrollTop();

		/* auto scroll bug */

		/* Calculate positions */

		var disHeight = scrollPos + (winHeight /2) - 50;

		/* Move stuff about */
		$('.popup-box').css({'width' : '100%', 'left' : '0px', 'top' : disHeight+'px'});
		$('#blackout').css({'width' : winWidth+'px', 'height' : winHeight+'px'});

		return false;
	}

	$(window).resize(centerBox);
	$(window).scroll(centerBox);
	centerBox();

     $('[class*=popup-box]').click(function(e) {
         /* Предотвращаем работу ссылки, если она являеться нашим popup окном */
         e.stopPropagation();
     });

     $('html').click(function() {
         var scrollPos = $(window).scrollTop();
         /* Скрыть окно, когда кликаем вне его области */
         $('[id^=popup-box-]').hide();
         $('#blackout').hide();
         $("html,body").css("overflow","auto");
         $('html').scrollTop(scrollPos);
     });
	 
     $('.close').click(function() {
         var scrollPos = $(window).scrollTop();
         /* Скрываем тень и окно, когда пользователь кликнул по X */
         $('[id^=popup-box-]').hide();
         $('#blackout').hide();
         $("html,body").css("overflow","auto");
         $('html').scrollTop(scrollPos);
     });
	});

</script>
</body>
</html>
